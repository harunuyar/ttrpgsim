namespace Dnd.Predefined.Traits;

using Dnd.System.CommandSystem.Commands.BaseCommands;
using Dnd.System.CommandSystem.Commands.BooleanResultCommands;
using Dnd.System.Entities.Damage;

public class Vulnerability : ATrait
{
    public Vulnerability(EDamageType damageType) : base("Vulnerability", "If a creature or an object has vulnerability to a damage type, damage of that type is doubled against it.")
    {
        DamageType = damageType;
    }

    public EDamageType DamageType { get; }

    public override void HandleCommand(ICommand command)
    {
        if (command is HasDamageVulnerability hasVulnerability)
        {
            if (DamageType.HasFlag(hasVulnerability.DamageType))
            {
                hasVulnerability.SetValue(this, true, $"You are vulnerable to {hasVulnerability.DamageType}.");
            }
        }
    }
}
